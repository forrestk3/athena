
/* create key space */
CREATE KEYSPACE fad WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 };

/* create Error-Msg table */
CREATE TABLE fad.EMessage (
/* index column */
    id uuid PRIMARY KEY,
    SdatapathId bigint,
    SportId int,
    SqeueueId bigint,
    StableId int,
    MinPort int,
    MinPhyPort int,
    MethDst bigint,
    MethSrc bigint,
    MethType int,
    MvlanVid int,
    MvlanPcp int, 
    MipDscp int,
    MipEcn int,
    MipProto int, 
    Mipv4Src int,
    Mipv4SrcMask int,
    Mipv4Dst int,
    Mipv4DstMask int,
    MtcpSrc int,
    MtcpDst int,
    MudpSrc int,
    MudpDst int,
    MmplsLabel int,
    MsctpSrc int,
    MsctpDst int,
    Micmpv4Code int,
    Micmpv4Type int,
    Mipv6Src int,
    Mipv6SrcMask int,
    Mipv6Dst int,
    Mipv6DstMask int,
    Mipv6Flabel int,
    Micmpv6Code int,
    Micmpv6Type int,
    Mipv6NdTarget int,
    Mipv6NdSll bigint,
    Mipv6NdTll bigint,
    Mipv6Exthdr int,
/* etc */
    timestamp timestamp,
    featureType int,
    featureCategory int,
/* payload column */
    EMerrorType int
);

/* create Flow-Removed table */
CREATE TABLE fad.FRemoved (
/* index column */
    id uuid PRIMARY KEY,
    SdatapathId bigint,
    SportId int,
    SqeueueId bigint,
    StableId int,
    MinPort int,
    MinPhyPort int,
    MethDst bigint,
    MethSrc bigint,
    MethType int,
    MvlanVid int,
    MvlanPcp int, 
    MipDscp int,
    MipEcn int,
    MipProto int, 
    Mipv4Src int,
    Mipv4SrcMask int,
    Mipv4Dst int,
    Mipv4DstMask int,
    MtcpSrc int,
    MtcpDst int,
    MudpSrc int,
    MudpDst int,
    MmplsLabel int,
    MsctpSrc int,
    MsctpDst int,
    Micmpv4Code int,
    Micmpv4Type int,
    Mipv6Src int,
    Mipv6SrcMask int,
    Mipv6Dst int,
    Mipv6DstMask int,
    Mipv6Flabel int,
    Micmpv6Code int,
    Micmpv6Type int,
    Mipv6NdTarget int,
    Mipv6NdSll bigint,
    Mipv6NdTll bigint,
    Mipv6Exthdr int,
/* etc */
    timestamp timestamp,
    featureType int,
    featureCategory int,
/* payload column */
    FRreason int,
    FRdurationSec bigint,
    FRdurationNSec bigint,
    FRidleTimeout int,
    FRhardTimeout int,
    FRpacketCount bigint,
    FRbyteCount bigint
);

/* create Packet-In table */
CREATE TABLE fad.Pin (
/* index column */
    id uuid PRIMARY KEY,
    SdatapathId bigint,
    SportId int,
    SqeueueId bigint,
    StableId int,
    MinPort int,
    MinPhyPort int,
    MethDst bigint,
    MethSrc bigint,
    MethType int,
    MvlanVid int,
    MvlanPcp int, 
    MipDscp int,
    MipEcn int,
    MipProto int, 
    Mipv4Src int,
    Mipv4SrcMask int,
    Mipv4Dst int,
    Mipv4DstMask int,
    MtcpSrc int,
    MtcpDst int,
    MudpSrc int,
    MudpDst int,
    MmplsLabel int,
    MsctpSrc int,
    MsctpDst int,
    Micmpv4Code int,
    Micmpv4Type int,
    Mipv6Src int,
    Mipv6SrcMask int,
    Mipv6Dst int,
    Mipv6DstMask int,
    Mipv6Flabel int,
    Micmpv6Code int,
    Micmpv6Type int,
    Mipv6NdTarget int,
    Mipv6NdSll bigint,
    Mipv6NdTll bigint,
    Mipv6Exthdr int,
/* etc */
    timestamp timestamp,
    featureType int,
    featureCategory int,
/* payload match column */
    PIMethDst bigint,
    PIMethSrc bigint,
    PIMethType int,
    PIMvlanVid int,
    PIMipv4Src int,
    PIMipv4Dst int,
    PIMipDscp int,
    PIMipEcn int,
    PIMipProto int,
    PIMtcpSrc int,
    PIMtcpDst int,
    PIMudpSrc int,
    PIMudpDst int,
    PIMicmpv4Code int,
    PIMicmpv4Type int, 
    PIMipv6Src int, 
    PIMipv6Dst int, 
    PIMicmpv6Code int,
    PIMicmpv6Type int,
    PItotalLen int,
    PIreason int,
    PIinPort int,
    PIinPhyPort int
);

/* create Port-Status table */
CREATE TABLE fad.PStatus (
/* index column */
    id uuid PRIMARY KEY,
    SdatapathId bigint,
    SportId int,
    SqeueueId bigint,
    StableId int,
    MinPort int,
    MinPhyPort int,
    MethDst bigint,
    MethSrc bigint,
    MethType int,
    MvlanVid int,
    MvlanPcp int, 
    MipDscp int,
    MipEcn int,
    MipProto int, 
    Mipv4Src int,
    Mipv4SrcMask int,
    Mipv4Dst int,
    Mipv4DstMask int,
    MtcpSrc int,
    MtcpDst int,
    MudpSrc int,
    MudpDst int,
    MmplsLabel int,
    MsctpSrc int,
    MsctpDst int,
    Micmpv4Code int,
    Micmpv4Type int,
    Mipv6Src int,
    Mipv6SrcMask int,
    Mipv6Dst int,
    Mipv6DstMask int,
    Mipv6Flabel int,
    Micmpv6Code int,
    Micmpv6Type int,
    Mipv6NdTarget int,
    Mipv6NdSll bigint,
    Mipv6NdTll bigint,
    Mipv6Exthdr int,
/* etc */
    timestamp timestamp,
    featureType int,
    featureCategory int,
/* payload column */
    PSreason int
);

/* create Flow-Statistics table */
CREATE TABLE fad.FStatistics (
/* index column */
    id uuid PRIMARY KEY,
    SdatapathId bigint,
    SportId int,
    SqeueueId bigint,
    StableId int,
    MinPort int,
    MinPhyPort int,
    MethDst bigint,
    MethSrc bigint,
    MethType int,
    MvlanVid int,
    MvlanPcp int, 
    MipDscp int,
    MipEcn int,
    MipProto int, 
    Mipv4Src int,
    Mipv4SrcMask int,
    Mipv4Dst int,
    Mipv4DstMask int,
    MtcpSrc int,
    MtcpDst int,
    MudpSrc int,
    MudpDst int,
    MmplsLabel int,
    MsctpSrc int,
    MsctpDst int,
    Micmpv4Code int,
    Micmpv4Type int,
    Mipv6Src int,
    Mipv6SrcMask int,
    Mipv6Dst int,
    Mipv6DstMask int,
    Mipv6Flabel int,
    Micmpv6Code int,
    Micmpv6Type int,
    Mipv6NdTarget int,
    Mipv6NdSll bigint,
    Mipv6NdTll bigint,
    Mipv6Exthdr int,
/* etc */
    timestamp timestamp,
    featureType int,
    featureCategory int,
/* payload column */
    FSSdurationSec bigint,
    FSSdurationNSec bigint,
    FSSpriority int,
    FSSidleTimeout int,
    FSShardTimeout int,
    FSSpacketCount bigint,
    FSSbyteCount bigint,
/* rich feature */
    FSSpacketCountVar bigint,
    FSSbyteCountVar bigint,
    FSSbytePerPacket double,
    FSSbytePerPacketVar double,
    FSSpacketPerDuration double,
    FSSpacketPerDurationVar double,
    FSSbytePerDuration double,
    FSSbytePerDurationVar double
);

/* create Queue-Statistics table */
CREATE TABLE fad.Qstatistics (
/* index column */
    id uuid PRIMARY KEY,
    SdatapathId bigint,
    SportId int,
    SqeueueId bigint,
    StableId int,
    MinPort int,
    MinPhyPort int,
    MethDst bigint,
    MethSrc bigint,
    MethType int,
    MvlanVid int,
    MvlanPcp int, 
    MipDscp int,
    MipEcn int,
    MipProto int, 
    Mipv4Src int,
    Mipv4SrcMask int,
    Mipv4Dst int,
    Mipv4DstMask int,
    MtcpSrc int,
    MtcpDst int,
    MudpSrc int,
    MudpDst int,
    MmplsLabel int,
    MsctpSrc int,
    MsctpDst int,
    Micmpv4Code int,
    Micmpv4Type int,
    Mipv6Src int,
    Mipv6SrcMask int,
    Mipv6Dst int,
    Mipv6DstMask int,
    Mipv6Flabel int,
    Micmpv6Code int,
    Micmpv6Type int,
    Mipv6NdTarget int,
    Mipv6NdSll bigint,
    Mipv6NdTll bigint,
    Mipv6Exthdr int,
/* etc */
    timestamp timestamp,
    featureType int,
    featureCategory int,
/* payload column */
    QSStxBytes bigint,
    QSStxPackets bigint,
    QSStxErrors bigint
);

/* create Table-Statistics table */
CREATE TABLE fad.TStatistics (
/* index column */
    id uuid PRIMARY KEY,
    SdatapathId bigint,
    SportId int,
    SqeueueId bigint,
    StableId int,
    MinPort int,
    MinPhyPort int,
    MethDst bigint,
    MethSrc bigint,
    MethType int,
    MvlanVid int,
    MvlanPcp int, 
    MipDscp int,
    MipEcn int,
    MipProto int, 
    Mipv4Src int,
    Mipv4SrcMask int,
    Mipv4Dst int,
    Mipv4DstMask int,
    MtcpSrc int,
    MtcpDst int,
    MudpSrc int,
    MudpDst int,
    MmplsLabel int,
    MsctpSrc int,
    MsctpDst int,
    Micmpv4Code int,
    Micmpv4Type int,
    Mipv6Src int,
    Mipv6SrcMask int,
    Mipv6Dst int,
    Mipv6DstMask int,
    Mipv6Flabel int,
    Micmpv6Code int,
    Micmpv6Type int,
    Mipv6NdTarget int,
    Mipv6NdSll bigint,
    Mipv6NdTll bigint,
    Mipv6Exthdr int,
/* etc */
    timestamp timestamp,
    featureType int,
    featureCategory int,
/* payload column */
    TSSmaxEntries bigint,
    TSSactiveCount bigint,
    TSSlookupCount bigint,
    TSSmatchedCount bigint
);

/* create Aggregate-Statistics table */
CREATE TABLE fad.AStatistics (
/* index column */
    id uuid PRIMARY KEY,
    SdatapathId bigint,
    SportId int,
    SqeueueId bigint,
    StableId int,
    MinPort int,
    MinPhyPort int,
    MethDst bigint,
    MethSrc bigint,
    MethType int,
    MvlanVid int,
    MvlanPcp int, 
    MipDscp int,
    MipEcn int,
    MipProto int, 
    Mipv4Src int,
    Mipv4SrcMask int,
    Mipv4Dst int,
    Mipv4DstMask int,
    MtcpSrc int,
    MtcpDst int,
    MudpSrc int,
    MudpDst int,
    MmplsLabel int,
    MsctpSrc int,
    MsctpDst int,
    Micmpv4Code int,
    Micmpv4Type int,
    Mipv6Src int,
    Mipv6SrcMask int,
    Mipv6Dst int,
    Mipv6DstMask int,
    Mipv6Flabel int,
    Micmpv6Code int,
    Micmpv6Type int,
    Mipv6NdTarget int,
    Mipv6NdSll bigint,
    Mipv6NdTll bigint,
    Mipv6Exthdr int,
/* etc */
    timestamp timestamp,
    featureType int,
    featureCategory int,
/* payload column */
    ASSpacketCount bigint,
    ASSbyteCount bigint,
    ASSflowCount bigint
);

/* port_stats table */
CREATE TABLE fad.PStatistics (
/* index column */
    id uuid PRIMARY KEY,
    SdatapathId bigint,
    SportId int,
    SqeueueId bigint,
    StableId int,
    MinPort int,
    MinPhyPort int,
    MethDst bigint,
    MethSrc bigint,
    MethType int,
    MvlanVid int,
    MvlanPcp int, 
    MipDscp int,
    MipEcn int,
    MipProto int, 
    Mipv4Src int,
    Mipv4SrcMask int,
    Mipv4Dst int,
    Mipv4DstMask int,
    MtcpSrc int,
    MtcpDst int,
    MudpSrc int,
    MudpDst int,
    MmplsLabel int,
    MsctpSrc int,
    MsctpDst int,
    Micmpv4Code int,
    Micmpv4Type int,
    Mipv6Src int,
    Mipv6SrcMask int,
    Mipv6Dst int,
    Mipv6DstMask int,
    Mipv6Flabel int,
    Micmpv6Code int,
    Micmpv6Type int,
    Mipv6NdTarget int,
    Mipv6NdSll bigint,
    Mipv6NdTll bigint,
    Mipv6Exthdr int,
/* etc */
    timestamp timestamp,
    featureType int,
    featureCategory int,
/* payload column */
    PSSrxPackets bigint,
    PSStxPackets bigint,
    PSSrxBytes bigint,
    PSStxBytes bigint,
    PSSrxDropped bigint,
    PSStxDropped bigint,
    PSSrxErrors bigint,
    PSStxErrors bigint,
    PSSrxFrameError bigint,
    PSSrxOverError bigint,
    PSSrxCrcError bigint,
    PSScollisions bigint,
/* rich feature */
    PSSrxPacketsVar bigint,
    PSStxPacketsVar bigint,
    PSSrxBytesVar bigint,
    PSStxBytesVar bigint,
    PSSrxDroppedVar bigint,
    PSStxDroppedVar bigint,
    PSSrxErrorsVar bigint,
    PSStxErrorsVar bigint,
    PSSrxFrameErrorVar bigint,
    PSSrxOverErrorVar bigint,
    PSSrxCrcErrorVar bigint,
    PSScollisionsVar bigint,

);

// index example
CREATE INDEX dpid_idx ON fad.PStatistics (SdatapathId);
CREATE INDEX rxpackets_idx ON fad.PStatistics (pssrxpackets);
CREATE INDEX PSStxPackets_idx ON fad.PStatistics (PSStxPackets);
CREATE INDEX pssrxbytes_idx ON fad.PStatistics (pssrxbytes);
CREATE INDEX PSStxBytes_idx ON fad.PStatistics (PSStxBytes);
CREATE INDEX PSSrxDropped_idx ON fad.PStatistics (PSSrxDropped);
CREATE INDEX PSStxDropped_idx ON fad.PStatistics (PSStxDropped);

SELECT * FROM fad.PStatistics
WHERE id = c22c9bc3-df1a-44e5-b780-5cee02e2229b and pssrxpackets > 10000 and psstxpackets > 10000
ALLOW FILTERING;
